# About SwiftSLR

SwiftSLR is a parser generator written in Swift, generating Simple LR (SLR) parsers in Swift.
The generator takes as input a string describing the desired grammar (which must be SLR parsable). It writes
an SLR parser accepting languages fitting that grammar to a file, and prints (to the console) an SLR automaton
that describes the operation of the parser.

## How do I use SwiftSLR?

To use SwiftSLR, first add it as a package to your project and import it in a Swift file. Then call the 
`SwiftSLR.Generator.generate` function. It takes as arguments a grammar (`String`), a 
`Bool` value indicating if a `Token` struct should be generated by SwiftSLR (pass `false`
if one is already defined, for instance via `SwiftLex`), and a path and name for the 
generated parser file.

## Input

The grammar `String` consists of several lines. Each line should contain at most one production. A production 
has a non-terminal (regex `[A-Z][a-zA-Z]*`) on the left. That non-terminal is followed by an arrow (`->`) and 
one or more symbols on the RHS of the production.

Each symbol is a non-terminal (as described above) or terminal (prefixed with `#`). Terminals will match whenever 
a token's type is equal to the specified terminal type. 

Note: The grammar's first production's LHS non-terminal should be unique so that it is the only accepting
production. The LHS symbol will be the only symbol on the stack when parsing is (successfully) completed.

### Example

Below is the SwiftSLR specification for the well-known expression grammar. Notice how only the first production
includes the `Expression` non-terminal, thus telling SwiftSLR that reducing to an `Expression` is the ultimate goal
of parsing. Also, notice that non-terminals start with an uppercase letter, and terminals are prefixed with `#`. 
```
Expression -> Sum
Sum -> Sum #+ Product
Sum -> Sum #- Product
Sum -> Product
Product -> Product #* Factor
Product -> Product #/ Factor
Product -> Factor
Factor -> #( Sum #)
Factor -> #identifier
Factor -> #integer
```

## Output

The parser generator will produce an SLR parser as its output. The SLR parser is found in an `SLRParser`
class. To use the parser, initialize an `SLRParser` instance and call its `parse` method. It expects an 
array of `Token` objects and produces an `SLRNode`. This `SLRNode` represents the root of the parse tree.
To access the whole tree, use the `children` property of the root `SLRNode` recursively.

## Integration with SwiftLex

[SwiftLex](https://github.com/Fleli/SwiftLex) is a lexer generator written in a similar way. SwiftSLR is
designed to work well with SwiftLex. If a SwiftLex lexer is present, it will include a `Token` type. The
user of SwiftSLR therefore has the option not to produce a `Token` type in the generated parser file (to
avoid multiple definitions). This is done by settings `includingToken` to `false` when generating the parser.

## Does SwiftSLR seem cumbersome?

SwiftSLR expects the user to
- Define the whole grammar
- Use the raw parse tree (of `SLRNode`s) directly

This gives the user full control over the whole parsing process, which is often desirable. However,
one might imagine a service that, in addition to letting the user define their grammar at a higher level, automatically
converts the raw `SLRNode` tree to some other tree structure. The [SwiftParse](https://github.com/Fleli/SwiftParse) project 
attempts to meet these needs. It adds some services on top of SwiftSLR to abstract away the details of
context free grammars.

## Inner workings

SwiftSLR is divided into 5 steps:
 Step   | Input             | Output            | Description 
--------|-------------------|-------------------|---------------------------------------------
1       | `String`          | `[Production]`    | Parse the user's input to see each production
2       | `[Production]`    | `Grammar`         | Create a grammar from the array of productions
3       | `Grammar`         | `Grammar`         | Compute the FIRST and FOLLOW sets for each non-terminal
4       | `Grammar`         | `SLRAutomaton`    | Use the grammar to create an SLR automaton
5       | `SLRAutomaton`    | `String`          | Generate code from the automaton

The `String` produced in step 5 is written to a file specified by the user.

## Future Updates

SwiftSLR currently does not accept empty productions. Fixing this is on the agenda since it is an important feature.

## Commit History

This project did not start out as a package, but rather as a command-line tool. To allow importing and using this tool, it is now converted to a package. The old project (with full commit history) is available at https://github.com/Fleli/SwiftSLR-Commits.
